# Constitution

## 1. Основные принципы
- **API**: Использовать FastAPI для проектирования API.
- **Python 3.13** Использоваь синтаксис актуальной версии Python 3.13.
- **Dependency Injection**: Для улучшения тестируемости и гибкости приложения использовать механизм Dependency Injection в FastAPI.
- **Type Annotations**: В коде использовать type annotations.
- **Validation**: Для валидаций использовать Pydantic V2 с Annotated типизацией.
- **Database Interaction**: Для взаимодействия с БД использовать SQLAlchemy.
- **Функциональность**: Делать только то, что требуется в фичах. Не добавлять лишнего.
- **Локализация**: Документировать код только на русском язык.
- **Документация**: Писать docstring для всех публичных функций и классов. Структура doststring согласно Google Docstring.
- **Структура**: Поддерживать и соблюдать архитектуру проекта.
- **Pydantic Settings**: Все настройки и конфигурации будут реализованы через Pydantic V2 с использованием аннотированной типизации, чтобы обеспечить строгую валидацию и поддержку типов данных.

## 2. Архитектура

```
app/
├── api/                    # API слой (обработчики запросов)
│   ├── v1/
│   │   ├── controllers/    # FastAPI route обработчики
│   │   ├── schemas/        # Pydantic модели запросов/ответов
│   │   └── router.py       # API v1 маршрутизация
│   ├── extra/              # Дополнительные эндпоинты (healthcheck и т.д.)
│   └── router.py           # Главный API роутер
├── clients/                # Клиенты внешних API
├── config.py               # Конфигурация через Pydantic Settings
├── db/
│   ├── base.py             # Базовый SQLAlchemy модель
│   ├── crud/               # Слой доступа к данным (BaseCrud)
│   ├── models/             # Модели таблиц БД
│   └── session.py          # Асинхронное подключение к БД
├── schemas/                # Общие Pydantic схемы
└── services/               # Слой бизнес-логики (BaseService)
```

### Слои
1. **Controllers**: обработчики FastAPI маршрутов, dependency injection, обработка запросов/ответов
2. **Services**: бизнес-логика, оркестрация CRUD операций
3. **CRUD**: прямые операции с БД используя дженерик `BaseCrud`
4. **Models**: определения таблиц SQLAlchemy, наследуются от `BaseDBModel`

### Базовые классы
- **BaseDBModel**: базовая SQLAlchemy модель с общими полями
- **BaseCrud**: дженерик CRUD операций для упрощения работы с базой данных и унификации операций.
- **BaseService**: этот класс будет использоваться как базовый для всех бизнес-логик, с возможностью расширения в зависимости от специфики фич.
- **BaseSchema**: общие Pydantic модели